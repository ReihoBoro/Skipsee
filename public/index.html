<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talk to strangers! - Random Video Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="script.js" defer></script>
    <script src="script.js" defer></script>
</head>

<body
    class="flex flex-col h-[100dvh] w-full overflow-hidden bg-[#f8fafc] dark:bg-gray-900 transition-colors duration-300">

    <!-- Header -->
    <div
        class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-md border-b border-gray-200 dark:border-gray-800 shadow-sm flex-shrink-0 w-full z-50 relative transition-colors duration-300">
        <div class="w-full py-2 px-4 md:py-3 md:px-6 flex items-center">
            <div class="omen-logo">
                <img src="Skipsee-3.svg" alt="Skipsee" class="h-14 object-contain">
            </div>
            <span
                class="hidden sm:inline text-sm font-medium text-gray-500 dark:text-gray-400 border-l border-gray-300 dark:border-gray-700 pl-4 ml-4">Talk
                to strangers!</span>

            <div class="absolute right-4 top-1/2 transform -translate-y-1/2 flex items-center gap-4">
                <div
                    class="text-sm text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full">
                    <span id="online-count-num" class="font-bold text-orange-600 dark:text-orange-400">0</span> online
                </div>

                <!-- User Profile -->
                <div class="relative">
                    <div id="user-profile"
                        class="flex items-center gap-3 pl-4 border-l border-gray-200 dark:border-gray-700 cursor-pointer">
                        <div class="text-right hidden sm:block">
                            <div id="user-name" class="text-sm font-semibold text-gray-800 dark:text-gray-100">Guest
                            </div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">Online</div>
                        </div>
                        <img id="user-avatar" src="https://ui-avatars.com/api/?name=Guest&background=random" alt="User"
                            class="w-8 h-8 rounded-full border border-gray-200 dark:border-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </div>

                    <!-- Dropdown Menu -->
                    <div id="user-profile-dropdown"
                        class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 py-1 hidden z-[100]">
                        <button id="settings-btn"
                            class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            Settings
                        </button>
                        <a href="mailto:help@skipsee.com"
                            class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z" />
                            </svg>
                            Helpline
                        </a>
                        <div class="border-t border-gray-100 dark:border-gray-700 my-1"></div>
                        <a href="/legal/terms.html" target="_blank"
                            class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-2">
                            Terms & Privacy
                        </a>
                        <a href="/legal/guidelines.html" target="_blank"
                            class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-2">
                            Guidelines
                        </a>
                        <div class="border-t border-gray-100 dark:border-gray-700 my-1"></div>
                        <a href="/logout"
                            class="w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                            </svg>
                            Logout
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App Area -->
    <div id="app" class="flex-1 w-full p-3 lg:p-6 flex flex-col lg:flex-row gap-4 overflow-hidden max-w-7xl mx-auto">

        <!-- Left Column: Video Containers -->
        <div
            class="videos-container flex flex-row lg:flex-col w-full lg:w-1/2 h-[30%] lg:h-full flex-shrink-0 gap-2 lg:gap-4 pb-2 lg:pb-0">

            <!-- Stranger Video -->
            <div id="stranger-video-wrapper"
                class="video-wrapper flex-1 relative group dark:bg-gray-800 dark:border-gray-700">
                <video id="remoteVideo" autoplay playsinline></video>
                <div class="video-placeholder">
                    <div class="text-center p-6">
                        <div
                            class="w-20 h-20 bg-gray-700/50 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-sm">
                            <svg class="w-10 h-10 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </div>
                        <span class="text-gray-300 font-semibold text-lg">Stranger</span>
                        <p class="text-gray-500 text-sm mt-1">Waiting for connection...</p>
                    </div>
                </div>
                <div id="static-overlay" class="absolute inset-0 z-10 overflow-hidden pointer-events-none"
                    style="display: block;">
                    <div class="static-noise"></div>
                </div>
                <div
                    class="absolute bottom-3 left-3 bg-black/60 backdrop-blur-md text-white text-xs px-2 py-1 rounded-md font-medium flex items-center gap-1">
                    Stranger <span id="stranger-flag">üåê</span> <span id="stranger-country">Global</span>
                </div>

                <!-- Stranger Menu -->
                <div class="absolute top-3 right-3 z-20">
                    <button id="stranger-menu-btn"
                        class="bg-black/40 hover:bg-black/60 text-white p-2 rounded-full backdrop-blur-md transition-all shadow-sm"
                        title="Options">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
                        </svg>
                    </button>
                    <!-- Dropdown -->
                    <div id="stranger-menu-dropdown"
                        class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 py-1 overflow-hidden">
                        <button id="block-user-action"
                            class="w-full text-left px-4 py-3 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-2 transition-colors border-b border-gray-100 dark:border-gray-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                            </svg>
                            Block User
                        </button>
                        <button id="report-user-action"
                            class="w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            Report User
                        </button>
                    </div>
                </div>
            </div>

            <!-- User Video -->
            <div id="user-video-wrapper" class="video-wrapper flex-1 relative dark:bg-gray-800 dark:border-gray-700">
                <video id="localVideo" autoplay muted playsinline style="transform: scaleX(-1);"></video>
                <div
                    class="absolute bottom-3 left-3 bg-black/60 backdrop-blur-md text-white text-xs px-2 py-1 rounded-md font-medium flex items-center gap-1">
                    You <span id="local-flag">üåê</span>
                </div>

                <!-- Media Controls Overlay -->
                <div class="absolute bottom-3 right-3 flex items-center gap-2">
                    <button id="mute-btn"
                        class="media-btn bg-black/60 hover:bg-black/80 text-white p-2 rounded-full backdrop-blur-md transition-all"
                        title="Mute Mic">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                            <path class="slash-icon hidden" stroke-linecap="round" stroke-linejoin="round"
                                stroke-width="2" d="M3 3l18 18" />
                        </svg>
                    </button>
                    <button id="camera-btn"
                        class="media-btn bg-black/60 hover:bg-black/80 text-white p-2 rounded-full backdrop-blur-md transition-all"
                        title="Turn Off Camera">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                            <path class="slash-icon hidden" stroke-linecap="round" stroke-linejoin="round"
                                stroke-width="2" d="M3 3l18 18" />
                        </svg>
                    </button>
                </div>
            </div>

        </div>

        <!-- Right Column: Chat & Controls -->
        <div
            class="flex flex-col w-full lg:w-1/2 h-[70%] lg:h-full chat-container dark:bg-gray-800 dark:border-gray-700 transition-colors duration-300">

            <!-- Chat Log -->
            <div id="chat-log"
                class="flex-grow p-6 overflow-y-auto bg-white dark:bg-gray-800 transition-colors duration-300">
                <!-- System messages removed -->
            </div>

            <!-- Controls Toolbar -->
            <div
                class="controls-container p-4 bg-gray-50 dark:bg-gray-900 border-t border-gray-100 dark:border-gray-700 transition-colors duration-300">

                <!-- Interest Tags Input -->
                <div class="mb-4">
                    <label
                        class="block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1 uppercase tracking-wider">Interests
                        (Optional)</label>
                    <div class="relative">
                        <div id="interests-container"
                            class="flex flex-wrap gap-2 p-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl min-h-[42px] focus-within:ring-2 focus-within:ring-orange-500/20 focus-within:border-orange-500 transition-all shadow-sm cursor-text">
                            <!-- Tags will appear here -->
                            <input type="text" id="interest-input" placeholder="Add interests (e.g., anime, music)..."
                                class="flex-grow min-w-[120px] outline-none text-sm bg-transparent border-none p-0 placeholder-gray-400 dark:placeholder-gray-500 text-gray-700 dark:text-gray-200">
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex items-center justify-between gap-3 mb-4">
                    <button id="start-stop-btn"
                        class="control-btn flex-1 bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-4 rounded-xl shadow-sm shadow-orange-200 transition-all">
                        START
                    </button>

                    <button id="next-btn"
                        class="control-btn flex-1 bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-4 rounded-xl shadow-sm shadow-orange-200 disabled:opacity-50 disabled:shadow-none"
                        disabled>
                        NEXT
                    </button>
                </div>

                <!-- Secondary Controls -->
                <div class="flex flex-wrap items-center gap-3">

                    <!-- Country -->


                    <div class="flex-grow"></div>
                </div>

                <!-- Input Area -->
                <div class="mt-3 relative">
                    <input type="text" id="chat-input" placeholder="Type a message..."
                        class="w-full pl-4 pr-24 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500 transition-all shadow-sm dark:text-white"
                        disabled>
                    <button id="send-btn"
                        class="absolute right-2 top-1.5 bg-orange-600 hover:bg-orange-700 text-white font-medium text-sm px-4 py-1.5 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                        disabled>
                        Send
                    </button>
                </div>

            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Settings Modal -->
    <div id="settings-modal" class="fixed inset-0 bg-black/50 z-[100] hidden flex items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-sm shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-bold text-gray-800 dark:text-white">Settings</h3>
                <button id="close-settings-btn"
                    class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <!-- Profile Settings -->
            <div class="mb-6">
                <h4 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 uppercase tracking-wider">
                    Profile
                </h4>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Display Name</label>
                    <div class="flex gap-2">
                        <input type="text" id="edit-name-input"
                            class="flex-1 p-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 outline-none text-sm">
                        <button id="save-profile"
                            class="px-3 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg font-medium text-sm">Save</button>
                    </div>
                </div>
            </div>

            <!-- Audio Settings -->
            <div class="mb-6">
                <h4 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 uppercase tracking-wider">
                    Audio
                </h4>

                <div class="mb-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm text-gray-600 dark:text-gray-400">Microphone
                            Volume</span>
                        <span id="gain-value" class="text-xs font-mono text-gray-500 dark:text-gray-400">1.0x</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" />
                        </svg>
                        <input type="range" id="audio-gain-slider" min="0" max="3" step="0.1" value="1"
                            class="w-full h-1 bg-gray-200 dark:bg-gray-600 rounded-lg appearance-none cursor-pointer">
                    </div>
                </div>

                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600 dark:text-gray-400">Noise
                        Reduction</span>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="noise-reduction-toggle" class="sr-only peer">
                        <div
                            class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 dark:peer-focus:ring-orange-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-orange-600">
                        </div>
                    </label>
                </div>
            </div>

            <!-- Appearance Settings -->
            <div class="mb-6">
                <h4 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 uppercase tracking-wider">
                    Appearance
                </h4>
                <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600 dark:text-gray-400">Dark Mode</span>
                    <div
                        class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                        <input type="checkbox" name="toggle" id="dark-mode-toggle"
                            class="toggle-checkbox absolute block w-5 h-5 rounded-full bg-white border-4 appearance-none cursor-pointer" />
                        <label for="dark-mode-toggle"
                            class="toggle-label block overflow-hidden h-5 rounded-full bg-gray-300 cursor-pointer"></label>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Report Modal -->
    <div id="report-modal" class="fixed inset-0 bg-black/50 z-[100] hidden flex items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-sm shadow-2xl">
            <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">Report User</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">Please describe the issue
                with the current
                user.
            </p>
            <textarea id="report-reason"
                class="w-full p-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none h-24 resize-none"
                placeholder="Reason for reporting..."></textarea>
            <div class="flex justify-end gap-2 mt-4">
                <button id="cancel-report"
                    class="px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg font-medium">Cancel</button>
                <button id="submit-report"
                    class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium">Submit
                    Report</button>
            </div>
        </div>
    </div>

    <!-- Age Verification Modal -->
    <div id="age-verification-modal"
        class="fixed inset-0 bg-black/90 z-[200] hidden flex items-center justify-center backdrop-blur-sm">
        <div
            class="bg-white dark:bg-gray-800 rounded-2xl p-8 w-full max-w-md shadow-2xl text-center border border-gray-200 dark:border-gray-700">
            <div class="mb-6">
                <div
                    class="w-20 h-20 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-4xl">18</span>
                </div>
                <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-2">Age
                    Verification</h2>
                <p class="text-gray-600 dark:text-gray-300">
                    You must be 18 years or older to enter this site.
                    Please confirm your age to proceed.
                </p>
            </div>

            <div class="flex flex-col gap-3">
                <button id="age-confirm-btn"
                    class="w-full py-3 px-4 bg-orange-600 hover:bg-orange-700 text-white font-bold rounded-xl transition-all shadow-lg shadow-orange-500/30 transform hover:scale-[1.02]">
                    I am 18 or older
                </button>
                <button id="age-deny-btn"
                    class="w-full py-3 px-4 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 font-medium rounded-xl transition-colors">
                    Exit
                </button>
            </div>
            <p class="mt-6 text-xs text-gray-400 dark:text-gray-500">
                By entering, you agree to our Terms of Service and Privacy Policy.
            </p>
        </div>
    </div>

</body>

</html>